---
title: 'Blog updates: TypeScript and Hooks'
date: '2019-02-10'
category: 'webdevelopment'
cover: ./stella-ribeiro-631365-unsplash.jpg
tags:
  - javascript
  - typescript
  - gatsby
published: false
---

Instead of writing a new blog post or changing the layout of my site, I've been procrastinating by updating my Gatsby site (this very site) with TypeScript and replacing the few class components that it had with functional components and `useState`.

Unfortunately this means no fresh deep-dives, hot-takes, and what-have-you's. All you're getting is a small update on the educational but slightly purposeless changes I've made.

## TypeScript

TypeScript seems to become the new normal, and I'm fine with that. I'm blissfully ignorant about most programming languages but JavaScript so for me adding TypeScript feels like a great improvement, albeit with a small learning curve.

### Configuration

To update my Gatsby blog with TypeScript, I began by replacing my `eslint` config files, packages and scripts with `tslint` config files, packages and scripts. Nosing around the Gatsby starters using TypeScript I found the packages and config files that I need and cobbled this setup together.

After changing all my components to `.tsx` extensions and normal JS files to `.ts` extensions it was time to go error-hunting!

### Creating type definitions

### Creating type modules for packages without types

When using a package that doesn't have any predefined type definitions, you can make or generate your own type definitions. In my case I had a package called `material-colors` which is an object export of all the colors in Google's material design. On converting my components to TypeScript I was introduced with the following error:

```javascript
Could not find a declaration file for module 'material-colors'.
  Try `npm install @types/material-colors` if it exists or add a new declaration (.d.ts) file containing `declare module 'material-colors';`
```

Okay so what now? In my search for an answer, I found the [`dts-gen`](https://github.com/Microsoft/dts-gen) npm package which can generate definitions from `js` files. I installed it globally, ran `dts-gen -m material-colors` from the root of my project and presto, a `material-colors.d.ts` file appeared. I should have type-checking and my error should be gone now, right? Nope! The error is still there and still no type checking.

On inspecting the file generated by `dts-gen` I found the following:

```typescript
export = material_colors;

declare const material_colors: {
    ...
```

Now to be fair, I'm not entirely sure what this means, but I do know we should have declare a module definition somewhere. So changing this file to the following:

```typescript
declare module 'material-colors' {
  export default material_colors;
}

const material_colors: {
  ...
```

Is what did the trick for me. Now last but not least, you should also make sure this file is included in your `tsconfig.json` `types` option.

### Object bracket notation

In case you need to use bracket notation to get the value of an object (like `object[key]`), TypeScript will present you with a `Element has no index signature` error, even if you declared an interface for your object. To fix your code, you need to add this index signature to your Object.

```typescript

interface Animation {
  opacity: number;
  scale: number;
}
interface Transition {
  entering: Animation;
  leaving: Animation;
}

 const transitionStyles: Transition = {
   entering: { opacity: 0; scale: 0.5; };
   entered: { opacity: 1: scale: 1; };
 }

 // Gives "Element has no index signature" error
 transitionStyles['entered];

```

To solve this, we need to add an `index signature` to our `TransitionI` interface:

```typescript
interface Transition {
  entering: Animation;
  leaving: Animation;
  [key: string]: Animation;
}
```

This way the error is resolved and we keep all the type-checking goodness!

## React Hooks
